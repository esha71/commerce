{% extends "auctions/layout.html" %}

{% block title %}
{{listing_obj.id}}:{{ listing_obj.name }}
{% endblock %}

{% block body %}
<style>
    .dmargin{
        margin: 0.4rem;
    }
    .hmargin{
        margin: 0 0.4rem;
    }
    ul{
        list-style: none;
    }
    .errorlist {
    border-width: 1px;
    border-color: red;
    border-style: solid;
    width: 300px;
    background-color: #ff8e8e;
    font-weight: 10px;
    text-transform: lowercase;
    }
    .errorlist:first-letter {
    text-transform: uppercase;
    }
    .info {
    border-width: 1px;
    border-color: green;
    border-style: solid;
    width: 300px;
    background-color: #b6ff8c;
    text-align: center;
    text-transform: lowercase
    }
    .info:first-letter {
    text-transform: uppercase;
    }
    .drelement{
        display: inline-block
    }
    img {
        max-height: 300px;
        max-width: 350px;
        border-color: black;
        border-width: 10px;
        border-width: 1px;
        border-color: black;
        border-style: solid;
        }
    button:hover {
        background-color: #005960;
        color: white;
}
    button {
    background-colour: default;
    border-radius: 10%;
}
    #id_description {
        height: 50px;
    }
    .dr {
    padding: 0.4rem;
    border-width: 2px;
    border-color: black;
    border-style: solid;
    overflow-wrap: anywhere;
    }
    .image {
        float: left;
    }

    .data{
       display: grid;
       grid-template-columns: auto 40% auto;
    }
    .comment {
    margin-bottom: 5px;
    }
    .hr {
    background-color: black;
    }
    .label_comment_description {
    float: left;
    }
    .comment_description {
    padding: 0 0 0 1rem;
    }
    .comment_date_created {
    size: 12px;
    color: gray;
    float: left;
    }
    .comment_part1{
        display:flex;
    }
    .created_by {
    font-size: 17px;

    }
    .comment_created_by {
    padding: 0rem 1rem;
    }
    label{
        display:none;
    }
    .comment_form{
        display: flex;
        vertical-align: middle;
        align-items: center;
     }


</style>
<div class="data">
    <div class="part1 image dmargin">
        <p class="image"><img src="{{ listing_obj.image_url }}"></p>
    </div>
    <div class="dv part2 dmargin">
        {% for f in listing_obj.get_all_fields %}
        <div class="dr">
            <label for="{{ f.label }}" class="drelement detailvaluelabel">
                <dt> {{f.label|capfirst}} :</dt>
            </label>
            <div class="drelement detailvalue" id="{{ f.label }}">
                {{f.value|escape|urlize|linebreaks}}
            </div>
        </div>
        {% endfor %}
    </div>
    <div class="part3 dmargin">

        {% if user.is_authenticated and listing_obj.status == "A" %}

        {% if messages %}
        <ul class="messages dmargin" xmlns="http://www.w3.org/1999/html">
            {% for message in messages %}
            <li {% if message.tags %} class=" {{ message.tags }} " {% endif %}> {{ message }}</li>
            {% endfor %}
        </ul>
        {% endif %}

        {% if listingOnUserWatchList %}
        <form class="dmargin" action="{% url 'remove_watchlist'%}" method="post">
            {% csrf_token %}
            <input type="text" name="id" value="{{listing_obj.id}}" hidden>
            <button> Remove from Watchlist</button>
        </form>
        {% else %}
        <form class="dmargin" action="{% url 'add_watchlist'%}" method="post">
            {% csrf_token %}
            <input type="text" name="id" value="{{listing_obj.id}}" hidden>
            <button> Add to Watchlist</button>
        </form>
        {% endif %}


        {% if user == listing_obj.created_by %}
            <a class="dmargin" href="/listing/{{listing_obj.id}}/close-bid/">
                <button>Close bid</button>
            </a>
            {% else %}
        <form class="bid_form dmargin" action="{% url 'submit_bid'%}" method="post">
            {% csrf_token %}
            {{ bid_form }}
            <button type="submit">$ Place your bid $</button>
        </form>
        {% endif %}
        <form class="comment_form dmargin" action="{% url 'post_comment'%}" method="post">
            {% csrf_token %}
            {{ comment_form }}
            <button class="hmargin" type="submit">Post comment</button>
        </form>


        {% elif user.is_authenticated and listing_obj.status == "C" and user == listing_obj.last_high_bid.user %}
        You are the winner!!!
        {% endif %}


        <hr class="hr dmargin">
        {% for comment in listing_obj.comments_listing.all.reverse %}
        <div class="comment dmargin">
            <div class="comment_part1">
                <div class="comment_created_by"><p class="created_by"><strong>{{ comment.created_by }}</strong></p>
                </div>
                <div class="comment_date_created">{{ comment.created_on }}</div>
            </div>

            <div class="comment_description"><p>{{ comment.description }}</p></div>

            <hr class="hr">
        </div>


        {% endfor %}
    </div>
</div>
{% endblock %}